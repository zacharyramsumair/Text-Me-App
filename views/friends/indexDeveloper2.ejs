<% layout('layouts/boilerplate')%>

<div class="container  index-top-half-div-1">
	<div class="index-top-half-div-2">
		<header class="header ">
			<h1>All friends</h1>
			<div>
				<a href="/friends/new">Add friend</a>
			</div>
		</header>
	
		
		<section class="section-today">
			<h2>Today</h2>
		
			<% for (let friend of friends){ %> 
				<% if (friend.nextDate==todayDate) {%> 
				<div class="card card-today" mb-3>
					<div class="row  card-center row-card">
						<div class="col-md-8">
							<div class="card-body today-center">
								<h5 class="card-title"><%= friend.name %></h5>
								<h5 class="card-title"> Do on <%= friend.nextDate %> </h5>
								<a class="btn btn-primary" href="/friends/<%=friend._id%>">View <%=friend.name%></a>
							</div>
						</div>
					</div>
				</div> 
			<% } %> 
			<% } %>
		</section>
			
	
		
<div class="section-upcoming">
			<h2>Upcoming</h2>
			<% for (let i = 0; i < upcomingDays.length; i++) { %> 
			<% for (let friend of friends){ %> 
				<% if (friend.nextDate==upcomingDays[i]) {%> 
					<div class="card card-upcoming" mb-3>
						<div class="row row-card">
							<div class="col-md-8">
								<div class="card-body">
									<h5 class="card-title"><%= friend.name %></h5>
									<% if ( i == 0){ %> 
										<h5 class="card-title">  <%= i+1 %> Day Left! </h5>
										<% }else{ %> 
											<h5 class="card-title">  <%= i+1 %> Days Left! </h5>
											<% } %> 
									
									<% //some reason friend.displayedNextDate shows one day before here %> 
									<% let displayNext = friend.baseDate.addDays(friend.level).toDateString() %> 
									<% console.log('===============',displayNext) %> 
									<h5 class="card-title">  <%= displayNext %> </h5>
									<a class="btn btn-primary" href="/friends/<%=friend._id%>">View <%=friend.name%></a>
								</div>
							</div>
						</div>
					</div> 
				<% } %> 
				<% }%> 
				<% } %>
	</div>
	
</div>	
</div>


<div class="section-categories">
		
	<section class="section-people">
		<h2>People</h2>
			<% for (let friend of friends){%> 
			<% if (friend.category=="People" ){ %>
			<div class="card" mb-3>
				<div class="row row-card">
					<div class="col-md-8">
						<div class="card-body">
							<h5 class="card-title"><%= friend.name %></h5>
							<p class="card-text"><%= friend.level %></p>
							<p class="card-text">
								<small class="text-muted"> <%= friend.description.substring(0, 50)%> </small>

							</p>
							<a class="btn btn-primary" href="/friends/<%=friend._id%>"
								>View <%=friend.name%></a
							>
						</div>
					</div>
				</div>
			</div>
			<% } %>
			 <% }%>
	</section>
			

	<section class="section-life">
		<h2>Life Maintenance</h2>
		<% for (let friend of friends){%> <% if (friend.category=="Life Maintenance" ){
		%>
		<div class="card" mb-3>
			<div class="row row-card">
				<div class="col-md-8">
					<div class="card-body">
						<h5 class="card-title"><%= friend.name %></h5>
						<p class="card-text"><%= friend.level %></p>
						<p class="card-text">
							<small class="text-muted"> <%= friend.description%> </small>
						</p>
						<a class="btn btn-primary" href="/friends/<%=friend._id%>"
							>View <%=friend.name%></a>
					</div>
				</div>
			</div>
		</div>
		<% } %> 
		<% }%>
	</section>
			
		
	<section class="section-other">
		<h2>Other</h2>
		<% for (let friend of friends){%> <% if (friend.category=="Other" ){
		%>
		<div class="card" mb-3>
			<div class="row row-card">
				<div class="col-md-8">
					<div class="card-body">
						<h5 class="card-title"><%= friend.name %></h5>
						<p class="card-text"><%= friend.level %></p>
						<p class="card-text">
							<small class="text-muted"> <%= friend.description%> </small>
						</p>
						<a class="btn btn-primary" href="/friends/<%=friend._id%>"
							>View <%=friend.name%></a>
					</div>
				</div>
			</div>
		</div>
		<% } %> 
		<% }%>
	</section>
</div>

